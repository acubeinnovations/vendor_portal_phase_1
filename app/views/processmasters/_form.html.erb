<%= form_for @processmaster, :html => { :multipart => true,:class => "form-horizontal" }  do |f| %>
	 <% if @processmaster.errors.any? %>
		 <div id="error_explanation">
		   <h2><%= pluralize(@processmaster.errors.count, "error") %> prohibited this post from being saved:</h2>

		   <ul>
		   <% @processmaster.errors.full_messages.each do |message| %>
		     <li><%= message %></li>
		   <% end %>
		   </ul>
		 </div>
	 <% end %>
	
<div class="container-fluid">
     <div class="row-fluid">
					<div class="span12">
						<div class="widget-box  border-bottom">
							<div class="widget-title">
								<span class="icon">
									<i class="icon-info-sign"></i>
								</span>
								<h5>Process Master</h5>
							</div>
							<div class="widget-content nopadding">
									<table class="table table-bordered">
										<tbody>
											<tr>
												<td style="<% if !@processmaster.persisted?  %><%= 'width:100%;'.to_s %><% else %><%= 'width:40%;'.to_s %><% end %>">
													<table class="table table-bordered border-left-0px">
														<tbody>
																<tr>
																<td>Name</td>
																
																<td><%= f.text_field :name, class:"span3" %></td>
															</tr>
																	<% if current_user.userrole==VendorPortal::Application.config.admin  %>
															<tr>
																<td>Division</td>
																<td>
																		<%if !@processmaster.division.blank? %>
																		<% div_id=@processmaster.division.id %>
																		<%else%>
																		<% div_id=''%>
																		<%end%>
																		<%= f.collection_select :division,Division.all,:id,:name, prompt: true,:selected=>div_id %>
																</td>
														</tr>
														<% else %><tr class="hide-me">
																<td>Division</td>
																<td>
																		<%= f.collection_select :division,Division.where('id'=>current_user.division.id),:id,:name, prompt: true,:selected=>current_user.division.id %>
																</td>
														</tr>
															<% end %>
															<tr>
																<td>Season</td>
																<td>
																	<%= f.collection_select :season_id,Season.all,:id,:name,  {:include_blank => "Please select"}%>
																</td>
															</tr>
															<tr>
																<td>Brand</td>
																<td>
																	<%= f.collection_select :brand_id,Brand.all,:id,:name,  {:include_blank => ""},:class=>'processmaster_brand add-select', :id=>"lstDropDown_A",:onKeyDown=>"fnKeyDownHandler_A(this, event);",:onKeyUp=>"fnKeyUpHandler_A(this, event); return false;",:onKeyPress => "return fnKeyPressHandler_A(this, event);" ,:onChange=>"fnChangeHandler_A(this);",:onFocus=>"fnFocusHandler_A(this);" %><i class="icon-plus-sign add-through-select" url="/ajaxcreate_brands"></i>
																</td>
															</tr>
														
															<tr>
																<td>Market</td>
																<td>
																	<%= f.collection_select :market_id,Market.all,:id,:name,  {:include_blank => ""},:class=>'processmaster_market add-select', :id=>"lstDropDown_A",:onKeyDown=>"fnKeyDownHandler_A(this, event);",:onKeyUp=>"fnKeyUpHandler_A(this, event); return false;",:onKeyPress => "return fnKeyPressHandler_A(this, event);" ,:onChange=>"fnChangeHandler_A(this);",:onFocus=>"fnFocusHandler_A(this);" %><i class="icon-plus-sign add-through-select" url="/ajaxcreate_markets"></i>
															</td>
															</tr>
													
															
														<tr>
																<td>Sub Market</td>
																<td>
																<%= f.collection_select :submarket_id,Submarket.all,:id,:name,  {:include_blank => ""},:class=>'processmaster_submarket add-select', :id=>"lstDropDown_A",:onKeyDown=>"fnKeyDownHandler_A(this, event);",:onKeyUp=>"fnKeyUpHandler_A(this, event); return false;",:onKeyPress => "return fnKeyPressHandler_A(this, event);" ,:onChange=>"fnChangeHandler_A(this);",:onFocus=>"fnFocusHandler_A(this);" %><i class="icon-plus-sign add-through-select" url="/ajaxcreate_submarkets"></i>
																</td>
														</tr>
														<tr>
																<td>Contact</td>
																<td>
																		<%= render :partial => "form_users",:object => @processmaster, :locals=>{:f=> f } %>
																</td>
														</tr>
													
															
															<tr>
																<td>Refer Style</td>
																<td class="border-none"> <%#= f.collection_select :style_ids,current_user.division.styles,:id,:stylename %>
																<% if current_user.userrole==VendorPortal::Application.config.operationadmin%>
																<%= f.select :style_ids ,current_user.division.styles.collect {|s| [ s.stylecode, s.id ] }, { include_blank: false },{ multiple: true } %>
																<%else if  current_user.userrole==VendorPortal::Application.config.admin  %>
																<%	if @processmaster.persisted?%> 
																<% @styleswithdiv=Style.where('division'=>@processmaster.division,'season'=>@processmaster.season).collect {|s| [ s.stylecode, s.id ] }%>
																<%else%>
																<% @styleswithdiv=''%>
																<%end%>
																	<%= f.select :style_ids ,@styleswithdiv, { include_blank: false },{ multiple: true } %>
																<% end %>
																	<% end %>
															</td>
															</tr>
													
															
														</tbody>
													</table>
												</td>
												
											</tr>
										</tbody>
									</table>
							</div>
							<div style="text-align:right" class="form-actions">
 										<%= f.submit 'Save', :class => 'btn btn-success btn-xs' %>
 							</div>
						</div>
					</div>
		</div>
</div>
<% end %>
