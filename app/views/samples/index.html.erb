
<div id="ajax-samples">

		<%= render 'index' %>

		<div class="container-fluid">
			<div class="row-fluid">
				<div class="span12">
					<div class="widget-box">
						<div class="widget-title">
							<span class="icon">
								<i class="icon-file"></i>
							</span>
							<h5>Listing Samples</h5><%  if current_user.userrole==VendorPortal::Application.config.designer %><%= link_to "Add New",'#', :class =>'btn btn-success btn-xs add-samples',:trackingsheet_id=>params[:trackingsheet_id] %> <%end%>
							</div>	
							<div class="scrollable-div" style="overflow-x: scroll;">
							<table class="table table-bordered comp-table">
								<thead>
									<tr>
									<th> PROTO/S/0 OR S/S</th>
										<th># OF DEV. SAMPLES NEEDED</th>
										<th>DAF ISSUED </th>
										<th>SAMPLE DUE DATE</th>
										<th>X-MILL</th>
										<th>RECEIVED </th>
										<th>APPROVED </th>
									</tr>
									</thead>
									<tbody>
									<% @a=1%>
									<% @samples.each do |sample|%>
										<tr>
											<td class="bestin" style="text-align:center;">
												<%=best_in_place_if soss,  sample, :soss, :as => :input,:nil => "Click to add content!"%>
											</td>
											<td class="bestin" style="text-align:center;">
												<%=best_in_place_if nmbrofdefsmplneeded,  sample, :nmbrofdefsmplneeded, :as => :input,:nil => "Click to add content!"%>
											</td>
											<td class="bestin" style="text-align:center;">
												<%=best_in_place_if dafissued,  sample, :dafissued, :as => :input,:nil => "Click to add content!"%>
											</td>
											<td class="bestin" style="text-align:center;">
												<%=best_in_place_if sampleduedate,  sample, :sampleduedate, :as => :input,:nil => "Click to add content!"%>
											</td>
											<td class="bestin" style="text-align:center;">
												<%=best_in_place_if xmill,  sample, :xmill, :as => :input,:nil => "Click to add content!"%>
											</td>
											<td class="bestin" style="text-align:center;">
												<%=best_in_place_if received,  sample, :received, :as => :input,:nil => "Click to add content!"%>
											</td>
											<td class="bestin" style="text-align:center;">
												
												<%#=best_in_place_if approved,  sample, :approved, :as => :input,:nil => "Click to add content!"%>
												<%if sample.approved=='yes'%>
												<%options="<option value=''>Please Select</option><option value='yes' selected>YES</option><option value='no'>NO</option>" %>
												<%else if sample.approved=='no' %>
												<%options="<option value=''>Please Select</option><option value='yes' >YES</option><option value='no' selected >NO</option>" %>							
												<%else%>
												<%options="<option value=''>Please Select</option><option value='yes' >YES</option><option value='no'>NO</option>" %>												<%end %>
												<%end %>
												<%= select_tag 'approved',options.html_safe,:class=>'yesorno',:sample_id=>sample.id,:trackingsheet_id=>params[:trackingsheet_id] %>
											</td>
										</tr>
									</tbody>
									<% @a=@a+1%>
									<% end %>
								</table>
								</div>
				</div>
			</div>
		</div>
	</div>
	<script type="text/javascripts">
		
		$('.yesorno').on('change',function(){
		var trackingsheetid=$(this).attr('trackingsheet_id');
		var sampleid=$(this).attr('sample_id');
		var approved=$(this).val();
		if(approved!=''){
		createandgetSamples(trackingsheetid,sampleid,approved);
		}
		});

		function createandgetSamples(trackingsheetid,sampleid,approved){
		var trackingsheetid=trackingsheetid;
		var sampleid=sampleid;
		var approved=approved;
		$.get("/ajaxcreate_samples", {
				trackingsheet:trackingsheetid,
					sampleid:sampleid,
					approved:approved
			},function(data){
				$('.modal').css('width','1200');
				$('.modal').css('left','30%');
				$('.modal-body').html(data);

			});


		}

		
$('.comp-table td span').on('keydown',function(e){ 

	var keyCode = e.keyCode || e.which; 

	if (e.shiftKey && keyCode == 9){

			findPrevTabindexcomp($(this).parent().prev());
			e.preventDefault(); 
	
	}else if (keyCode == 9) { 
		 findNextTabindexcomp($(this).parent().next());
			e.preventDefault(); 
   
  }
});
	


function findNextTabindexcomp(next){

if(next.children().is("span")){
$('#'+next.find('span').attr('id')).trigger('click');

}else{
nextspan=next.next();
findNextTabindexcomp(nextspan);

}
}

function findPrevTabindexcomp(prev){

if(prev.children().is("span")){
$('#'+prev.find('span').attr('id')).trigger('click');

}else{
prevspan=prev.prev();
findPrevTabindexcomp(prevspan);

}
}

$("#close-modal").click(function(){
$('.modal-body').html('');
location.reload();
});


	</script>

	<%= javascript_include_tag "application" %>
</div>




